import { useState } from "react";
import { Button, TextField, IconButton, Typography } from "@mui/material";
import AddPhotoAlternateIcon from "@mui/icons-material/AddPhotoAlternate";
import DeleteIcon from "@mui/icons-material/Delete";

export default function AddClub() {
const [steps, setSteps] = useState([]);

const addStep = () => {
setSteps([
...steps,
{ id: Date.now(), name: "", content: "", image: null },
]);
};

const removeStep = (id) => {
setSteps(steps.filter((step) => step.id !== id));
};

const handleStepChange = (id, field, value) => {
setSteps(
steps.map((step) => (step.id === id ? { ...step, [field]: value } : step))
);
};

const handleSubmit = (e) => {
e.preventDefault();
console.log("Submitting data...");
const formData = new FormData(e.target);
console.log(Object.fromEntries(formData.entries()));
};

return (
<div className="max-w-4xl mx-auto p-4">
    <Typography variant="h4" className="mb-6 text-center">
        Thêm Club
    </Typography>
    <form onSubmit={handleSubmit} className="space-y-6">
        {/* Tên Club */}
        <div>
            <TextField label="Tên Club" name="clubName" variant="outlined" fullWidth required />
        </div>

        {/* Title */}
        <div>
            <TextField label="Title" name="clubTitle" variant="outlined" fullWidth required />
        </div>

        {/* Mô tả */}
        <div>
            <TextField label="Mô tả" name="clubDescription" variant="outlined" fullWidth multiline rows={4} required />
        </div>

        {/* Mục tiêu */}
        <div>
            <TextField label="Mục tiêu" name="clubGoals" variant="outlined" fullWidth multiline rows={4} required />
        </div>

        {/* Ảnh */}
        <div className="space-y-2">
            <label className="block font-medium">Ảnh</label>
            <input type="file" name="clubImages" multiple />
        </div>

        {/* Lộ trình */}
        <div>
            <Typography variant="h5" className="mb-4">
                Lộ trình
            </Typography>
            {steps.map((step, index) => (
            <div key={step.id} className="border border-gray-300 rounded-lg p-4 mb-4 relative">
                <div className="flex items-center justify-between my-2">
                    <h4 className="text-gray-700">Bước {index + 1}</h4>
                    <IconButton onClick={()=> removeStep(step.id)}
                        className="-mt-3 rounded-full p-2 bg-slate-300 hover:bg-slate-400"
                        >
                        <DeleteIcon color="error" />
                    </IconButton>
                </div>
                <TextField label={`Tên Bước ${index + 1}`} value={step.name} onChange={(e)=>
                    handleStepChange(step.id, "name", e.target.value)
                    }
                    name={`steps[${index}][name]`}
                    variant="outlined"
                    fullWidth
                    required
                    className="mb-4"
                    />
                    <TextField label="Nội dung" value={step.content} onChange={(e)=>
                        handleStepChange(step.id, "content", e.target.value)
                        }
                        name={`steps[${index}][content]`}
                        variant="outlined"
                        fullWidth
                        multiline
                        rows={3}
                        required
                        className="mb-4"
                        />
                        <div className="flex items-center">
                            <label htmlFor={`step-image-${index}`} className="flex items-center gap-2 cursor-pointer">
                                <AddPhotoAlternateIcon />
                                <Typography>Chọn ảnh</Typography>
                            </label>
                            <input id={`step-image-${index}`} type="file" name={`steps[${index}][image]`}
                                className="hidden" onChange={(e)=>
                            handleStepChange(step.id, "image", e.target.files[0])
                            }
                            />
                        </div>
            </div>
            ))}

            <Button variant="outlined" onClick={addStep} className="w-full mt-4">
                Thêm bước
            </Button>
        </div>

        {/* Nút lưu */}
        <Button type="submit" variant="contained" color="primary" fullWidth>
            Lưu Club
        </Button>
    </form>
</div>
);
}