<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Danh sách tỉnh/thành phố</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        select,
        button {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Checkout</h1>

        <!-- Tỉnh/Thành phố -->
        <label for="province">Tỉnh/Thành phố</label>
        <select id="province">
            <option value="">Chọn tỉnh/thành phố</option>
        </select>

        <!-- Quận/Huyện -->
        <label for="district">Quận/Huyện</label>
        <select id="district" disabled>
            <option value="">Chọn quận/huyện</option>
        </select>

        <!-- Xã/Phường -->
        <label for="ward">Xã/Phường</label>
        <select id="ward" disabled>
            <option value="">Chọn xã/phường</option>
        </select>
    </div>

    <script>
        // Fetch danh sách tỉnh/thành phố
        async function fetchProvinces() {
            try {
                const response = await fetch("https://provinces.open-api.vn/api/p/");
                const provinces = await response.json();
                const provinceSelect = document.getElementById("province");

                provinces.forEach((province) => {
                    const option = document.createElement("option");
                    option.value = province.code;
                    option.textContent = province.name;
                    provinceSelect.appendChild(option);
                });
            } catch (error) {
                console.error("Lỗi khi lấy danh sách tỉnh/thành phố:", error);
            }
        }

        // Fetch danh sách quận/huyện theo mã tỉnh
        async function fetchDistricts(provinceCode) {
            try {
                const response = await fetch(`https://provinces.open-api.vn/api/p/${provinceCode}?depth=2`);
                const data = await response.json();
                const districtSelect = document.getElementById("district");
                districtSelect.innerHTML = '<option value="">Chọn quận/huyện</option>';
                document.getElementById("ward").innerHTML = '<option value="">Chọn xã/phường</option>'; // Reset ward
                document.getElementById("ward").disabled = true;

                data.districts.forEach((district) => {
                    const option = document.createElement("option");
                    option.value = district.code;
                    option.textContent = district.name;
                    districtSelect.appendChild(option);
                });

                districtSelect.disabled = false;
            } catch (error) {
                console.error("Lỗi khi lấy danh sách quận/huyện:", error);
            }
        }

        // Fetch danh sách xã/phường theo mã quận/huyện
        async function fetchWards(districtCode) {
            try {
                const response = await fetch(`https://provinces.open-api.vn/api/d/${districtCode}?depth=2`);
                const data = await response.json();
                const wardSelect = document.getElementById("ward");
                wardSelect.innerHTML = '<option value="">Chọn xã/phường</option>';

                data.wards.forEach((ward) => {
                    const option = document.createElement("option");
                    option.value = ward.code;
                    option.textContent = ward.name;
                    wardSelect.appendChild(option);
                });

                wardSelect.disabled = false;
            } catch (error) {
                console.error("Lỗi khi lấy danh sách xã/phường:", error);
            }
        }

        // Sự kiện thay đổi cho Tỉnh/Thành phố
        document.getElementById("province").addEventListener("change", (e) => {
            const provinceCode = e.target.value;
            if (provinceCode) {
                fetchDistricts(provinceCode);
            } else {
                document.getElementById("district").innerHTML = '<option value="">Chọn quận/huyện</option>';
                document.getElementById("district").disabled = true;
                document.getElementById("ward").innerHTML = '<option value="">Chọn xã/phường</option>';
                document.getElementById("ward").disabled = true;
            }
        });

        // Sự kiện thay đổi cho Quận/Huyện
        document.getElementById("district").addEventListener("change", (e) => {
            const districtCode = e.target.value;
            if (districtCode) {
                fetchWards(districtCode);
            } else {
                document.getElementById("ward").innerHTML = '<option value="">Chọn xã/phường</option>';
                document.getElementById("ward").disabled = true;
            }
        });

        // Load danh sách tỉnh/thành phố khi tải trang
        fetchProvinces();
    </script>
</body>

</html>